\documentclass[a4paper, norsk, twoside, 10pt]{article}
%trennger en pakke med norske symboler
\usepackage[utf8]{inputenc}
\usepackage[a4]{}
\usepackage[norsk]{babel}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{color}
\usepackage{listings}

%\usepackage{epsfig}
%\usepackage{graphicx}
%\usepackage{float}


%\usepackage{tikz}
%\usetikzlibrary{arrows}


\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}

\lstdefinestyle{custommat}{language=Matlab,
  %basicstyle=\color{red},
  breaklines=true,%
  morekeywords={matlab2tikz},
  keywordstyle=\color{blue},%
  morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},
  identifierstyle=\color{black},%
  stringstyle=\color{mylilas},
  commentstyle=\color{mygreen},%
  showstringspaces=false,%without this there will be a symbol in the places where there is a space
  frame = L,
  emph=[1]{for,end,break},emphstyle=[1]\color{red}, %some words to emphasise
  %emph=[2]{word1,word2}, emphstyle=[2]{style},
}



\date{\today}
\title{Oblig2 \\ mat1120}
\author{Elsie Mestl}

\begin{document}
\maketitle
\begin{flushleft}


  \section*{Oppgave 1}
  \subsubsection*{i)}

  Har at:
  \[
  p(t) = a_{0} + a_{1}t +  t^{2} \qquad
  C = \begin{bmatrix}
    0 & 1 \\
    -a_{0} & -a_{1} \\
  \end{bmatrix}
  \]
  \\
  \ \\


  Regner ut det karektaristiske polynomet til C
  \begin{align*}
    P(\lambda_{C}) &= \text{det}(C)\\
    &= (-\lambda)(-a_{1} - \lambda) + a_{0} \\
    &= a_{0} + \lambda a_{1} + \lambda^{2}
  \end{align*}

  Ser at \[P(\lambda_{C}) = p(t), \quad t = \lambda\]




  \subsubsection*{ii)}

  \[
  p(t) = a_{0} + a_{1}t +  a_{3}t^{2} + t^{3} \qquad
  C = \begin{bmatrix}
    0 & 1 & 0\\
    0 & 0 & 1 \\
    -a_{0} & -a_{1} & -a_{2} \\
  \end{bmatrix} \] \\
  \ \\
  Regner ut det karektaristiske polynomet til C
  \begin{align*}
    P(\lambda_{C}) &= \text{det}(C)\\
    &= -\lambda(-\lambda(-a_{2} - \lambda) + a_{1}) -a_{0}(1 - ( -\lambda \cdot 0))\\
    &= \lambda^{2}(-a_{2} - \lambda) - \lambda a_{1} - a_{0} \\
    &= -\lambda^{3} - \lambda^{2}a_{2} -\lambda a_{1} - a_{0}
  \end{align*}

  Ser at \[P(\lambda_{C}) = -p(t), \quad t = \lambda\]


  \newpage

  \section*{Oppgave 2}

  \subsection*{i)}
  Har at\[f'''(t) = 4f(t) + 4f'(t)- f''(t)\]
  Vis at $\mathbf{x}(t) = (f(t), f'(t), f''(t))$ er en løsning.

  \begin{align*}
    \mathbf{x}'(t) &= \mathcal{C}\mathbf{x}(t) \\
    &= \begin{bmatrix}
      0 & 1 & 0 \\
      0 & 0 & 1 \\
      4 & 4 & -1 \\
    \end{bmatrix}
    \begin{bmatrix}
      f(t) \\
      f'(t) \\
      f''(t) \\
    \end{bmatrix}
    \\
    &= \begin{bmatrix}
      0 + f'(t) + 0 \\
      0 + 0 + f''(t) \\
      4f(t) + 4f'(t) -f''(t) \\
    \end{bmatrix} \\
    &= \begin{bmatrix}
      f'(t) \\
      f''(t) \\
      f'''(t)\\
    \end{bmatrix} \\
  \end{align*}

  \subsection*{ii)}

  Vis at $f(t) = x_{1}(t)$ er en løsning for (*) når $\mathbf{x}(t) = (x_{1}(t), x_{2}(t) , x_{3}(t))$ er en løsning for (**) \\

  Finner egenverdien og egenvektorene til C. Vha matlab, og får at C har egenvektorene:

  \begin{align*}
    \mathbf{v}_{1} =
    \begin{bmatrix}
      0.25 \\
      0.5 \\
      1\\
    \end{bmatrix}
    \quad
    \mathbf{v}_{2} =
    \begin{bmatrix}
      0.25 \\
      -0.5 \\
      1\\
    \end{bmatrix}
    \quad
    \mathbf{v}_{3} =
    \begin{bmatrix}
      1 \\
      -1 \\
      1\\
    \end{bmatrix} \\
    \intertext{med respektive egenverdier:} \\
    \lambda_{1} = 2 \quad \lambda_{2} = -2 \quad \lambda_{3} = -1 \quad
  \end{align*}

  Har videre at:

  \begin{align*}
    \mathbf{x}(t) &= c_{1}\mathbf{v}_{1}e^{2t} + c_{2}\mathbf{v}_{2}e^{-2t} + c_{3}\mathbf{v}_{3}e^{-t} \\
    &= c_{1}\begin{bmatrix}
      0.25 \\
      0.5 \\
      1\\
    \end{bmatrix}e^{2t} +
    c_{2}\begin{bmatrix}
      0.25 \\
      -0.5 \\
      1\\
    \end{bmatrix}e^{-2t} +
    c_{3}\begin{bmatrix}
      1 \\
      -1 \\
      1\\
    \end{bmatrix}e^{-t} \\*
    &=
    \begin{bmatrix}
      0.25c_{1}e^{2t} + 0.25c_{2}e^{-2t} + c_{3}e^{-t} \\
      0.5c_{1}e^{2t} - 0.5c_{2}e^{-2t} - c_{3}e^{-t} \\
      c_{1}e^{2t} + c_{2}e^{-2t} + c_{3}e^{-t} \\
    \end{bmatrix}
    \intertext{Siden:}
    \mathbf{x}(t) &= (x_{1}(t), x_{2}(t) , x_{3}(t))
  \end{align*}

  Har vi:

  \begin{align*}
    x_{1}(t) &= 0.25c_{1}e^{2t} + 0.25c_{2}e^{-2t} + c_{3}e^{-t} \\
    x_{2}(t) &= 0.5c_{1}e^{2t} - 0.5c_{2}e^{-2t} - c_{3}e^{-t} \\
    x_{3}(t) &=c_{1}e^{2t} + c_{2}e^{-2t} + c_{3}e^{-t} \\
  \end{align*}

  Siden \[f(t) = x_{1}(t)  =0.25c_{1}e^{2t} + 0.25c_{2}e^{-2t} + c_{3}e^{-t}  \]
  Setter vi inn for $f(t)$ i (*) ser vi at:

  \begin{align*}
    f'''(t) +f''(t) &-4f'(t) -4f(t) \\&= -4(0.25c_{1}e^{2t} + 0.25c_{2}e^{-2t} + c_{3}e^{-t}) -4(0.5c_{1}e^{2t} - 0.5c_{2}e^{-2t} - c_{3}e^{-t} )\\ &\quad+ c_{1}e^{2t} + c_{2}e^{-2t} + c_{3}e^{-t} + 2c_{1}e^{2t}  -2c_{2}e^{-2t} - c_{3}e^{-t} \\
    &= 0 \quad \text{ved enkel algebra}
  \end{align*}

  Dermed har vi at $f(t) = x_{1}(t)$ er en løsning for (*)


  \subsection*{iii)}

  Regnet ut i oppgave 2ii)\\ Den generelle løsningen er:

  \[\mathbf{x}(t) = c_{1}\mathbf{v}_{1}e^{2t} + c_{2}\mathbf{v}_{2}e^{-2t} + c_{3}\mathbf{v}_{3}e^{-t} \]


  Har at \[\mathbf{x}(0) = (1 , 0 , -2)\]

  Setter inn verdien for $t = 0$ og $\mathbf{x}(0)$ inn i den generelle formelen og får:

  \begin{align*}
    1 &= 0.25c_{1}e^{0} + 0.25c_{2}e^{0} + c_{3}e^{0} = 0.25c_{1} + 0.25c_{2} +c_{3} &\text{(1)}\\
    0 &= 0.5c_{1}e^{0} - 0.5c_{2}e^{0} - c_{3}e^{0} = 0.5c_{1} -0.5c_{2} - c_{3} & \text{(2)}\\
    -2 &=c_{1}e^{0} + c_{2}e^{0} + c_{3}e^{0} = c_{1} + c_{2} + c_{3} & \text{(3)}\\
    \ \\
    c_{3} &= 0.5(c_{1} - c_{2})  &\text{(2)}\\
    \ \\
    1 &= 0.25(c_{1} + c_{2}) + 0.5(c_{1} - c_{2}) = 0.75c_{1} -0.25c_{2} & \text{(1+2)}\\
    -2 &= c_{1} + c_{2} + 0.5(c_{1} - c_{2}) = 1.5 c_{1} + 0.5c_{2} & \text{(2+3)} \\
    \ \\
    c_{2} &= -4 -3c_{1} & \text{(2+3)} \\
    \ \\
    1 &= 0.75 c_{1} - 0.25(-4 -3c_{1}) = 0.75c_{1} + 1 + 0.75c_{1} = 1.5 c_{1} & \text{(1+2+3)}\\
    \ \\
    c_{1} &= \frac{2}{3} &\\
    c_{2} &= -6 &\\
    c_{3} &= \frac{10}{3} &\\
    \ \\
    \intertext{Altså er:} \\
    \mathbf{x}(t) &= \frac{2}{3}\mathbf{v}_{1}e^{2t} -6\mathbf{v}_{2}e^{-2t} + \frac{10}{3}\mathbf{v}_{3}e^{-t} \\
  \end{align*}




  \subsection*{iv)}
  Som vist i oppgave 2ii) så er den generelle løsningen for (*):
  \[f(t) = 0.25c_{1}e^{2t} + 0.25c_{2}e^{-2t} + c_{3}e^{-t} \]
  Altså for alle reelle verdier av $c_{1}, c_{2}, c_{3}$ så er $f(t)$ løsning for (*)
  \\
  \ \\
  \[f(0) = 1 \quad f'(0) = 0 \quad f''(0) = -2, \qquad t = 0\]

  Siden vi har fra Oppgave 2i at $\mathbf{x}(t)  = (f(t) , f'(t) , f''(t))$ er en løsning for (**) ser vi at $c_{1}, c_{2}, c_{3}$ får de samme verdiene som i oppgaven over. Altså blir
  \[f(t) = \frac{1}{3}e^{2t} - \frac{3}{2}e^{-2t} + \frac{10}{3}e^{-t}\]



  \section*{Oppgave 3}

  \subsection*{i)}

  Hvis $\mathbf{v}_{\lambda}$ er en egenvektor for $\mathcal{C}$ med egenverdien $\lambda$ så er:

  \[\mathcal{C}\mathbf{v}_{\lambda} = \lambda \mathbf{v}_{\lambda}\]

  \begin{align*}
    \mathcal{C}\mathbf{v}_{\lambda} &=
    \begin{bmatrix}
      \lambda \\
      \lambda^{2} \\
      \vdots \\
      \lambda^{n-1} \\
      -a_{0} - a_{1}\lambda \cdots -a_{n-1}\lambda^{n-1}\\
    \end{bmatrix}
    &\begin{matrix}
       \begin{split}
         p(\lambda) &= 0\\
         -a_{0} - a_{1}\lambda \cdots -a_{n-1}\lambda^{n-1} &= -p(\lambda) + \lambda^{n} \\
         &= 0 +\lambda^{n}
       \end{split}
     \end{matrix} \\
    &= \lambda
    \begin{bmatrix}
      1 \\
      \lambda \\
      \vdots \\
      \lambda^{n-2} \\
      \lambda^{n-1} \\
    \end{bmatrix}
    = \lambda \mathbf{v}_{\lambda}
  \end{align*}

  \subsection*{ii)}

  \[E_{\lambda} = \{\mathbf{x} \in \mathbb{R} \, | \, \mathcal{C} \mathbf{x} = \lambda \mathbf{x}\}\]

  Siden $\mathbf{v}_{\lambda}$ er en egenvektor til $\mathcal{C}$ så er $\mathbf{v}_{\lambda} \in E_{\lambda}$
  \ \\
  Anta videre at $\mathbf{x}  \neq c\mathbf{v}_{\lambda}, \, c \in \mathbb{R}$ og $\mathbf{x} \in E_{\lambda}$
  \begin{align*}
    \mathcal{C}\mathbf{x} &=
    \mathcal{C}\begin{bmatrix}
      x_{0} \\
      x_{1} \\
      \vdots \\
      x_{n-1} \\
    \end{bmatrix}
    = \begin{bmatrix}
      x_{1} \\
      x_{2} \\
      \vdots \\
      -(a_{0}x_{0} + a_{1} + \cdots + a_{n-1}x_{x-1}) \\
    \end{bmatrix}
    = \lambda \begin{bmatrix}
      x_{0} \\
      x_{1} \\
      \vdots \\
      x_{n-1} \\
    \end{bmatrix} \\
    \intertext{Altså har vi at:}
    x_{1} &= \lambda x_{0} \\
    x_{2} &= \lambda x_{1} \\
    &\vdots \\
    \lambda x_{n-1} &= -(a_{0}x_{0} + a_{1}x_{1} + \cdots + a_{n-1}x_{x-1})\\
    \intertext{Setter vi inn $x_{1}$ i formelen for $x_{2}$ og $x_{2}$ for $x_{3}$ osv. Ser vi at:}
    x_{1} &= \lambda x_{0} \\
    x_{2} &= \lambda^{2} x_{0} \\
    &\vdots\\
    \lambda^{n}x_{0} &=-(a_{0}x_{0} + \lambda a_{1}x_{0} + \cdots + \lambda^{n-1}a_{n-1}x_{0}) \implies
    \lambda^{n} = -(a_{0} + \lambda a_{1} + \cdots + \lambda^{n-1}a_{n-1})
    \intertext{Dette kan vi se på som følgende:}
    \mathcal{C}\mathbf{x} &=
    \begin{bmatrix}
      \lambda x_{0} \\
      \lambda^2 x_{0} \\
      \vdots \\
      \lambda^{n} x_{0} \\
    \end{bmatrix} =
    \lambda \begin{bmatrix}
      x_{0} \\
      \lambda x_{0} \\
      \vdots \\
      \lambda^{n-1} x_{0} \\
    \end{bmatrix}
  \end{align*}

  Her har vi en selvmotsigelse siden vi antokk at $\mathbf{x}  \neq c\mathbf{v}_{\lambda}, \, c \in \mathbb{R}$. Men det er nettopp dette vi har fått i utregningene. Altså kan ikke $\mathbf{x}$ være lineært uavhengig av $\mathbf{v}_{\lambda}$ og samtidig være en egenvektor for $\mathcal{C}$ med egnverdi $\lambda$  \\ \ \\

  Dermed har vi at $E_{\lambda}$ består av alle multipler av $\mathbf{v}_{\lambda}$ som videre betyr at $dim(E) = 1$ og at $E = \text{Span}\{\mathbf{v}_{\lambda}\}$.


  \subsection*{iii)}

  $\mathcal{C}$ er diagonaliserbar, hvis og bare hvis:

  \begin{align*}
    \mathcal{C} = PDP^{-1}
  \end{align*}

  Hvis $p$ har $n$ distinkte røtter, betyr det at $\mathcal{C}$ har $n$ distinkte egenverdier. Det betyr at det finnes en $D$ som består av egenverdiene. Altså finnes det en matrise $P$ hvor kollonnene er de respektive egenvektorene. Siden det er $n$ distinke egenverdier er egenvektorene lineært uavhengide. Altså er kollonnene i $P$ lineærtuavhengige og $P$ er invertibel. Og vi har at $\mathcal{C}$ er diagonaliserbar hvis $p$ har $n$ distikte røtter.
  \\ \ \\
  Hvis $\mathcal{C}$ er diagonaliserbar vet vi det finne sen diagonalmatrise $D$ som består av alle egenverdiene til $\mathcal{C}$. I oppgave 3ii) viste vi at $dim(E_{\lambda}) = 1$ og dette gjelder for alle lamba. Altså for at $P$ skal være invertibel må den bestå av n lineærtuavhengide kolonner. Altså har $\mathcal{C}$ n lineært uavhnegige egenvektorer, og dermed også egenverdir. Siden $p = p(t)$ og $p$ har verdien til $\lambda$ så er løsningen til $p(t)$ lik alle verdiene til $\lambda$ altså $n$ distinkte røtter.
  \\ \ \\
  \begin{align*}
    P &= [\mathbf{v}_{0} \, \mathbf{v}_{1} \, (\cdots) \, \mathbf{v}_{n-1} ]  =
    \begin{bmatrix}
      1 & 1  & \cdots & 1 \\
      \lambda_0 & \lambda_1 & \cdots & \lambda_{n-1} \\
      & & \ddots& \\
      \lambda^{n-1}_{0} & \lambda^{n-1}_{1} & \cdots & \lambda^{n-a}_{n-1} \\
    \end{bmatrix}\\
  \end{align*}

\newpage
  \section*{Oppgave 4}
  \subsection*{i)}

  \lstinputlisting[style = custommat]{stdrot.m}
\newpage
  \subsection*{ii)}

  \lstinputlisting[language = Matlab, frame = single]{stdrot_cmd_roots}
\newpage

  Kommentarer: \\
  Ser at programmet finner den dominante roten for p1, (største av de røttene root(p1) gir ut). Men finner ikke for p2. Dette er fordi selv om det ved første øyenkast kanskje ser slik ut, så har ikke p2 en reell rot, absolutt verdien til de to komplekse er noe, men svært lite større.


  \section*{Oppgave 5}
  \lstinputlisting[language = Matlab, frame = single]{pascal_roots}


  Ser at stdrot() finner den største roten til A! OSB: hadde vi i i stdrot() satt $\mathbf{x}$ til å være en så ville vi fått ut 1, og dette har med at vi finner roten med en gang, og den sjekker ikke for andre verdier...

\newpage
  \section*{Oppgave 6}
  \lstinputlisting[language = Matlab, frame = single]{QR_fact}
  Printer ikke ut $A_{1}$ til $A_{7}$ men kun den siste. Er for å forhindre en oversvømmelse av unødvendig utskrift.
  Ser at diagonalen i $A_{8}$ tilsvarer egenverdiene til $A$ altså er $A_{8}$ en diagonalmatrise for $A$
\end{flushleft}
\end{document}
